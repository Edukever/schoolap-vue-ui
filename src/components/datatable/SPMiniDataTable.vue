<template>
    <div class="sp-data-table">
        <table class="sp-mini-data-table">
            <thead>
                <tr>
                    <th v-for="(item, index) in columns" :key="index">
                        <div class="sp-title">
                            <p class="sp-label">{{ item.label }}</p>
                            <div class="sp-spam-mini" :class="{'sp-sort':item.sortable}" @click="sort(item.field)">
                                <div class="sp-sort-up">
                                    <svg width="7" height="4" viewBox="0 0 7 4" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M5.97213 3.52973C5.90563 3.52973 5.83913 3.50523 5.78663 3.45273L3.50463 1.17073C3.33663 1.00273 3.06363 1.00273 2.89563 1.17073L0.613629 3.45273C0.512129 3.55423 0.344129 3.55423 0.242629 3.45273C0.141129 3.35123 0.141129 3.18323 0.242629 3.08173L2.52463 0.799734C2.89563 0.428734 3.50113 0.428734 3.87563 0.799734L6.15763 3.08173C6.25913 3.18323 6.25913 3.35123 6.15763 3.45273C6.10513 3.50173 6.03863 3.52973 5.97213 3.52973Z" fill="#292D32"/>
                                    </svg>
                                </div>
                                <div class="sp-sort-down">
                                    <svg width="7" height="4" viewBox="0 0 7 4" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M5.97213 0.870656C5.90563 0.870656 5.83913 0.895156 5.78663 0.947656L3.50463 3.22966C3.33663 3.39766 3.06363 3.39766 2.89563 3.22966L0.613629 0.947656C0.512129 0.846156 0.344129 0.846156 0.242629 0.947656C0.141129 1.04916 0.141129 1.21716 0.242629 1.31866L2.52463 3.60066C2.89563 3.97166 3.50113 3.97166 3.87563 3.60066L6.15763 1.31866C6.25913 1.21716 6.25913 1.04916 6.15763 0.947656C6.10513 0.898656 6.03863 0.870656 5.97213 0.870656Z" fill="#292D32"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="(row, index) in sortedData" :key="index">
                    <td class="sp-td">{{ row.classe }}</td>
                    <td>
                        <div class="sp-badget">
                            <div  v-for="(item, index) in row.cours" :key="index" class="sp-badget-table-blue">
                                {{ item.name }}
                            </div>
                        </div>
                    </td>
                    <td>
                        <svg @click="handleClicked" width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M10 1.75C9.02154 1.75 8.1871 2.37503 7.87787 3.24993C7.73983 3.64047 7.31134 3.84517 6.9208 3.70713C6.53026 3.56909 6.32557 3.1406 6.46361 2.75007C6.97804 1.29459 8.36609 0.25 10 0.25C11.634 0.25 13.022 1.29459 13.5365 2.75007C13.6745 3.1406 13.4698 3.56909 13.0793 3.70713C12.6887 3.84517 12.2602 3.64047 12.1222 3.24993C11.813 2.37503 10.9785 1.75 10 1.75Z" fill="#292D32"/>
                            <path d="M0.75 5C0.75 4.58579 1.08579 4.25 1.5 4.25H18.5001C18.9143 4.25 19.2501 4.58579 19.2501 5C19.2501 5.41421 18.9143 5.75 18.5001 5.75H1.5C1.08579 5.75 0.75 5.41421 0.75 5Z" fill="#292D32"/>
                            <path d="M3.91508 7.45011C3.88753 7.03681 3.53015 6.72411 3.11686 6.75166C2.70356 6.77921 2.39085 7.13659 2.41841 7.54989L2.88186 14.5016C2.96735 15.7844 3.03641 16.8205 3.19838 17.6336C3.36678 18.4789 3.6532 19.185 4.2448 19.7384C4.83639 20.2919 5.55994 20.5307 6.41459 20.6425C7.23663 20.75 8.27507 20.75 9.56066 20.75H10.4395C11.7251 20.75 12.7635 20.75 13.5856 20.6425C14.4402 20.5307 15.1638 20.2919 15.7554 19.7384C16.347 19.185 16.6334 18.4789 16.8018 17.6336C16.9637 16.8205 17.0328 15.7844 17.1183 14.5016L17.5818 7.54989C17.6093 7.13659 17.2966 6.77921 16.8833 6.75166C16.47 6.72411 16.1126 7.03681 16.0851 7.45011L15.6251 14.3492C15.5353 15.6971 15.4712 16.6349 15.3307 17.3405C15.1943 18.025 15.004 18.3873 14.7306 18.6431C14.4572 18.8988 14.083 19.0647 13.391 19.1552C12.6776 19.2485 11.7376 19.25 10.3868 19.25H9.6134C8.26256 19.25 7.32255 19.2485 6.60915 19.1552C5.91715 19.0647 5.54299 18.8988 5.26957 18.6431C4.99616 18.3873 4.80583 18.025 4.66948 17.3405C4.52891 16.6349 4.46488 15.6971 4.37503 14.3492L3.91508 7.45011Z" fill="#292D32"/>
                            <path d="M7.42546 9.25372C7.83762 9.21251 8.20515 9.51321 8.24636 9.92537L8.74637 14.9254C8.78758 15.3375 8.48687 15.7051 8.07471 15.7463C7.66256 15.7875 7.29502 15.4868 7.25381 15.0746L6.75381 10.0746C6.71259 9.66247 7.0133 9.29494 7.42546 9.25372Z" fill="#292D32"/>
                            <path d="M13.2464 10.0746C13.2876 9.66247 12.9869 9.29494 12.5747 9.25372C12.1626 9.21251 11.795 9.51321 11.7538 9.92537L11.2538 14.9254C11.2126 15.3375 11.5133 15.7051 11.9255 15.7463C12.3376 15.7875 12.7051 15.4868 12.7464 15.0746L13.2464 10.0746Z" fill="#292D32"/>
                        </svg>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</template>

<script>
    export default {
        name: 'SPMiniDataTable',
        props:{
            rows: {
                type: Array,
                required: true
            },
            columns: {
                type: Array,
                required: true
            }
        },
        data(){
            return{
                sortKey: '',
                sortOrder:1
            }
        },
        computed:{
            sortedData() {
                return [...this.rows].sort((a, b) => {
                    if (this.sortKey === '') return 0;
                    if (a[this.sortKey] < b[this.sortKey]) return -1 * this.sortOrder;
                    if (a[this.sortKey] > b[this.sortKey]) return this.sortOrder;
                    return 0;
                });
            },
        },
        methods: {
            sort(key) {
                if (this.sortKey === key) {
                    this.sortOrder = this.sortOrder * -1;
                } else {
                    this.sortKey = key;
                    this.sortOrder = 1;
                }
            },
            handleClicked(){
                this.$emit('clicked');
            }
        }
    }
</script>